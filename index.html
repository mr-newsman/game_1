<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Egyptian Hieroglyph Starfield</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Egyptian+Hieroglyphs&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #000;
            overflow: hidden;
            font-family: 'Noto Sans Egyptian Hieroglyphs', sans-serif;
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        #starfield {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .hieroglyph {
            position: absolute;
            color: #d4af37;
            text-shadow:
                0 0 10px rgba(212, 175, 55, 0.5),
                0 0 20px rgba(212, 175, 55, 0.3),
                0 0 30px rgba(212, 175, 55, 0.2),
                0 0 40px rgba(212, 175, 55, 0.1);
            animation: pulse 4s ease-in-out infinite;
            transition: opacity 1s ease-in-out;
            user-select: none;
            pointer-events: none;
        }

        .hieroglyph.small {
            font-size: 20px;
        }

        .hieroglyph.medium {
            font-size: 35px;
        }

        .hieroglyph.large {
            font-size: 50px;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 0.3;
                transform: scale(0.95);
            }
            50% {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.5);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: scale(1);
            }
            to {
                opacity: 0;
                transform: scale(0.5);
            }
        }

        #controls {
            position: fixed;
            top: -300px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(20, 20, 20, 0.95);
            border: 1px solid #d4af37;
            border-radius: 0 0 10px 10px;
            padding: 20px;
            color: #d4af37;
            transition: top 0.3s ease-in-out;
            z-index: 1000;
            min-width: 350px;
            font-family: Arial, sans-serif;
        }

        #controls.active {
            top: 0;
        }

        #controls h3 {
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 1px solid #d4af37;
            padding-bottom: 10px;
        }

        .control-group {
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .control-group label {
            flex: 1;
            font-size: 14px;
        }

        .control-group input[type="range"] {
            flex: 1;
            margin: 0 10px;
        }

        .control-group span {
            min-width: 40px;
            text-align: right;
            font-size: 14px;
        }

        .preset-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
        }

        .preset-buttons button {
            background: #d4af37;
            color: #000;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }

        .preset-buttons button:hover {
            background: #e6c157;
        }

        #controlHint {
            position: fixed;
            bottom: 20px;
            right: 20px;
            color: rgba(212, 175, 55, 0.3);
            font-size: 12px;
            font-family: Arial, sans-serif;
            transition: color 0.3s;
        }

        #controlHint:hover {
            color: rgba(212, 175, 55, 0.7);
        }

        #authorName {
            position: fixed;
            bottom: 20px;
            left: 20px;
            color: rgba(212, 175, 55, 0.3);
            font-size: 12px;
            font-family: Arial, sans-serif;
            transition: color 0.3s;
        }

        #authorName:hover {
            color: rgba(212, 175, 55, 0.7);
        }

        .emoji {
            position: absolute;
            font-size: 30px;
            cursor: pointer;
            user-select: none;
            pointer-events: auto;
            z-index: 100;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .emoji.small {
            font-size: 24px;
        }

        .emoji.medium {
            font-size: 36px;
        }

        .emoji.large {
            font-size: 48px;
        }

        @keyframes fall {
            to {
                transform: translateY(calc(100vh + 100px));
            }
        }

        @keyframes pop {
            0% {
                transform: scale(1) rotate(0deg);
            }
            50% {
                transform: scale(2.5) rotate(180deg);
            }
            100% {
                transform: scale(0) rotate(360deg);
                opacity: 0;
            }
        }

        .boom {
            position: absolute;
            font-size: 60px;
            z-index: 200;
            pointer-events: none;
            animation: boom 0.6s ease-out forwards;
        }

        @keyframes boom {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 1;
            }
            50% {
                transform: scale(1.5) rotate(180deg);
            }
            100% {
                transform: scale(2) rotate(360deg);
                opacity: 0;
            }
        }

        .boom-mode {
            animation: shake 0.5s infinite;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .mode-toggle {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #d4af37;
            text-align: center;
        }

        .mode-toggle button {
            background: #d4af37;
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
            width: 100%;
        }

        .mode-toggle button:hover {
            background: #e6c157;
        }

        #fullscreenBtn {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(212, 175, 55, 0.3);
            color: #d4af37;
            border: 2px solid #d4af37;
            border-radius: 8px;
            padding: 10px 15px;
            cursor: pointer;
            font-size: 24px;
            z-index: 9999;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
        }

        #fullscreenBtn:hover {
            background: rgba(212, 175, 55, 0.5);
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
        }
    </style>
</head>
<body>
    <div id="starfield"></div>

    <div id="controls">
        <h3>Ancient Sky Controls</h3>
        <div class="control-group">
            <label>Cycling Speed:</label>
            <input type="range" id="cyclingSpeed" min="50" max="500" value="200">
            <span id="cyclingSpeedValue">200</span>
        </div>
        <div class="control-group">
            <label>Glow Intensity:</label>
            <input type="range" id="glowIntensity" min="1" max="10" value="5">
            <span id="glowIntensityValue">5</span>
        </div>
        <div class="control-group">
            <label>Active Glyphs:</label>
            <input type="range" id="activeGlyphs" min="5" max="50" value="20">
            <span id="activeGlyphsValue">20</span>
        </div>
        <div class="control-group">
            <label>Fade Speed (s):</label>
            <input type="range" id="fadeSpeed" min="1" max="10" value="3">
            <span id="fadeSpeedValue">3</span>
        </div>
        <div class="control-group">
            <label>Pulse Duration (s):</label>
            <input type="range" id="pulseDuration" min="2" max="10" value="4">
            <span id="pulseDurationValue">4</span>
        </div>
        <div class="preset-buttons">
            <button onclick="applyPreset('calm')">Calm Temple</button>
            <button onclick="applyPreset('active')">Active Ritual</button>
        </div>
        <div class="mode-toggle">
            <button id="modeToggle" onclick="toggleMode()">Click 4 Times Fast for Emoji Rain! 🎉</button>
        </div>
    </div>

    <button id="fullscreenBtn" onclick="toggleFullscreen()" title="Toggle Fullscreen">⛶</button>
    <div id="authorName">Benjamin L. Miles</div>
    <div id="controlHint">Ctrl+Space - Controls</div>

    <script>
        const emojis = [
            '😀', '😃', '😄', '😁', '😆', '😅', '🤣', '😂', '🙂', '🙃',
            '😉', '😊', '😇', '🥰', '😍', '🤩', '😘', '😗', '😚', '😙',
            '😋', '😛', '😜', '🤪', '😝', '🤑', '🤗', '🤭', '🤫', '🤔',
            '😐', '😑', '😶', '😏', '😒', '🙄', '😬', '🤥', '😌', '😔',
            '😪', '🤤', '😴', '😷', '🤒', '🤕', '🤢', '🤮', '🤧', '🥵',
            '🥶', '🥴', '😵', '🤯', '🤠', '🥳', '😎', '🤓', '🧐', '😕',
            '😟', '🙁', '☹️', '😮', '😯', '😲', '😳', '🥺', '😦', '😧',
            '😨', '😰', '😥', '😢', '😭', '😱', '😖', '😣', '😞', '😓',
            '😩', '😫', '🥱', '😤', '😡', '😠', '🤬', '😈', '👿', '💀'
        ];

        const hieroglyphs = [
            '𓀀', '𓀁', '𓀂', '𓀃', '𓀄', '𓀅', '𓀆', '𓀇', '𓀈', '𓀉',
            '𓀊', '𓀋', '𓀌', '𓀍', '𓀎', '𓀏', '𓀐', '𓀑', '𓀒', '𓀓',
            '𓀔', '𓀕', '𓀖', '𓀗', '𓀘', '𓀙', '𓀚', '𓀛', '𓀜', '𓀝',
            '𓁀', '𓁁', '𓁂', '𓁃', '𓁄', '𓁅', '𓁆', '𓁇', '𓁈', '𓁉',
            '𓂀', '𓂁', '𓂂', '𓂃', '𓂄', '𓂅', '𓂆', '𓂇', '𓂈', '𓂉',
            '𓃀', '𓃁', '𓃂', '𓃃', '𓃄', '𓃅', '𓃆', '𓃇', '𓃈', '𓃉',
            '𓄀', '𓄁', '𓄂', '𓄃', '𓄄', '𓄅', '𓄆', '𓄇', '𓄈', '𓄉',
            '𓅀', '𓅁', '𓅂', '𓅃', '𓅄', '𓅅', '𓅆', '𓅇', '𓅈', '𓅉',
            '𓆀', '𓆁', '𓆂', '𓆃', '𓆄', '𓆅', '𓆆', '𓆇', '𓆈', '𓆉',
            '𓇀', '𓇁', '𓇂', '𓇃', '𓇄', '𓇅', '𓇆', '𓇇', '𓇈', '𓇉',
            '𓈀', '𓈁', '𓈂', '𓈃', '𓈄', '𓈅', '𓈆', '𓈇', '𓈈', '𓈉',
            '𓉀', '𓉁', '𓉂', '𓉃', '𓉄', '𓉅', '𓉆', '𓉇', '𓉈', '𓉉'
        ];

        const settings = {
            cyclingSpeed: 200,
            glowIntensity: 5,
            activeGlyphs: 20,
            fadeSpeed: 3,
            pulseDuration: 4,
            emojiRainActive: false
        };

        const starfield = document.getElementById('starfield');
        const controls = document.getElementById('controls');
        const activeHieroglyphs = new Map();
        const activeEmojis = new Map();
        let hieroglyphInterval = null;
        let emojiInterval = null;
        let clickTimes = [];
        let boomModeTimeout = null;

        function getRandomHieroglyph() {
            return hieroglyphs[Math.floor(Math.random() * hieroglyphs.length)];
        }

        function getRandomEmoji() {
            return emojis[Math.floor(Math.random() * emojis.length)];
        }

        function getRandomSize() {
            const sizes = ['small', 'medium', 'large'];
            return sizes[Math.floor(Math.random() * sizes.length)];
        }

        function createHieroglyph() {
            const element = document.createElement('div');
            element.className = `hieroglyph ${getRandomSize()}`;
            element.textContent = getRandomHieroglyph();

            const x = Math.random() * window.innerWidth;
            const y = Math.random() * window.innerHeight;

            element.style.left = `${x}px`;
            element.style.top = `${y}px`;
            element.style.animationDuration = `${settings.pulseDuration}s`;

            const shouldCycle = Math.random() > 0.3;

            starfield.appendChild(element);

            element.style.animation = `fadeIn 0.5s ease-in-out forwards, pulse ${settings.pulseDuration}s ease-in-out infinite`;

            const glyphData = {
                element,
                cycleInterval: null,
                fadeTimeout: null
            };

            if (shouldCycle) {
                glyphData.cycleInterval = setInterval(() => {
                    element.textContent = getRandomHieroglyph();
                }, settings.cyclingSpeed);
            }

            const lifetime = 5000 + Math.random() * 10000;

            glyphData.fadeTimeout = setTimeout(() => {
                element.style.animation = `fadeOut ${settings.fadeSpeed}s ease-in-out forwards`;

                if (glyphData.cycleInterval) {
                    clearInterval(glyphData.cycleInterval);
                }

                setTimeout(() => {
                    if (element.parentNode) {
                        starfield.removeChild(element);
                    }
                    activeHieroglyphs.delete(element);
                }, settings.fadeSpeed * 1000);
            }, lifetime);

            activeHieroglyphs.set(element, glyphData);
        }

        function updateGlowIntensity() {
            const intensity = settings.glowIntensity;
            const alpha1 = 0.1 * intensity;
            const alpha2 = 0.06 * intensity;
            const alpha3 = 0.04 * intensity;
            const alpha4 = 0.02 * intensity;

            const style = document.createElement('style');
            style.textContent = `
                .hieroglyph {
                    text-shadow:
                        0 0 ${10 * intensity}px rgba(212, 175, 55, ${alpha1}),
                        0 0 ${20 * intensity}px rgba(212, 175, 55, ${alpha2}),
                        0 0 ${30 * intensity}px rgba(212, 175, 55, ${alpha3}),
                        0 0 ${40 * intensity}px rgba(212, 175, 55, ${alpha4});
                }
            `;

            const existingStyle = document.querySelector('style[data-glow]');
            if (existingStyle) {
                existingStyle.remove();
            }
            style.setAttribute('data-glow', 'true');
            document.head.appendChild(style);
        }

        function createEmoji() {
            const element = document.createElement('div');
            element.className = `emoji ${getRandomSize()}`;
            element.textContent = getRandomEmoji();

            const x = Math.random() * (window.innerWidth - 50);
            element.style.left = `${x}px`;
            element.style.top = '-50px';

            const fallSpeed = 6 + Math.random() * 6; // Slower: 6-12 seconds
            element.style.animation = `fall ${fallSpeed}s linear`;

            starfield.appendChild(element);

            const handlePop = (e) => {
                e.stopPropagation();

                // Get current position of the emoji
                const rect = element.getBoundingClientRect();
                const currentX = rect.left;
                const currentY = rect.top;

                // Transform to boom emoji and fix position during animation
                element.textContent = '💥';
                element.style.left = `${currentX}px`;
                element.style.top = `${currentY}px`;
                element.style.animation = 'pop 0.4s ease-out forwards';
                activeEmojis.delete(element);

                setTimeout(() => {
                    if (element.parentNode) {
                        starfield.removeChild(element);
                    }
                }, 400);
            };

            // Add both click and touch events
            element.addEventListener('click', handlePop);
            element.addEventListener('touchstart', (e) => {
                e.preventDefault(); // Prevent default touch behavior
                handlePop(e);
            });

            const removeTimeout = setTimeout(() => {
                if (element.parentNode) {
                    starfield.removeChild(element);
                }
                activeEmojis.delete(element);
            }, fallSpeed * 1000);

            activeEmojis.set(element, { element, removeTimeout });
        }

        function manageHieroglyphs() {
            if (activeHieroglyphs.size < settings.activeGlyphs) {
                createHieroglyph();
            }
        }

        function manageEmojis() {
            if (settings.emojiRainActive && activeEmojis.size < 20) { // Reduced max from 30 to 20
                createEmoji();
            }
        }

        function clearEmojis() {
            activeEmojis.forEach(data => {
                if (data.removeTimeout) clearTimeout(data.removeTimeout);
                if (data.element.parentNode) {
                    starfield.removeChild(data.element);
                }
            });
            activeEmojis.clear();
        }

        function activateEmojiRain() {
            settings.emojiRainActive = true;
            document.body.classList.add('boom-mode');
            document.getElementById('modeToggle').textContent = '💥 EMOJI RAIN ACTIVE 💥 (Click to Stop)';

            // Start emoji rain (slower spawn rate)
            if (emojiInterval) clearInterval(emojiInterval);
            emojiInterval = setInterval(manageEmojis, 250); // Reduced from 100ms to 250ms

            // Create initial burst
            for (let i = 0; i < 10; i++) {
                setTimeout(() => createEmoji(), i * 50);
            }

            // No auto-deactivate - rain continues until manually stopped
        }

        function deactivateEmojiRain() {
            settings.emojiRainActive = false;
            document.body.classList.remove('boom-mode');
            clickTimes = [];

            if (emojiInterval) clearInterval(emojiInterval);
            emojiInterval = null;

            clearEmojis();
            document.getElementById('modeToggle').textContent = 'Click 4 Times Fast for Emoji Rain! 🎉';
        }

        function toggleMode() {
            if (settings.emojiRainActive) {
                deactivateEmojiRain();
            } else {
                activateEmojiRain();
            }
        }

        // Global click/touch detection for rapid clicks/taps
        const handleRapidTap = (e) => {
            const now = Date.now();
            clickTimes.push(now);
            clickTimes = clickTimes.filter(t => now - t < 800);

            if (clickTimes.length >= 4 && !settings.emojiRainActive) {
                activateEmojiRain();
            }
        };

        document.addEventListener('click', handleRapidTap);
        document.addEventListener('touchstart', (e) => {
            // Only count touch if not on an emoji
            if (!e.target.classList.contains('emoji')) {
                handleRapidTap(e);
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.code === 'Space') {
                e.preventDefault();
                controls.classList.toggle('active');
            }
        });

        document.getElementById('cyclingSpeed').addEventListener('input', (e) => {
            settings.cyclingSpeed = parseInt(e.target.value);
            document.getElementById('cyclingSpeedValue').textContent = e.target.value;

            activeHieroglyphs.forEach(data => {
                if (data.cycleInterval) {
                    clearInterval(data.cycleInterval);
                    data.cycleInterval = setInterval(() => {
                        data.element.textContent = getRandomHieroglyph();
                    }, settings.cyclingSpeed);
                }
            });
        });

        document.getElementById('glowIntensity').addEventListener('input', (e) => {
            settings.glowIntensity = parseInt(e.target.value);
            document.getElementById('glowIntensityValue').textContent = e.target.value;
            updateGlowIntensity();
        });

        document.getElementById('activeGlyphs').addEventListener('input', (e) => {
            settings.activeGlyphs = parseInt(e.target.value);
            document.getElementById('activeGlyphsValue').textContent = e.target.value;
        });

        document.getElementById('fadeSpeed').addEventListener('input', (e) => {
            settings.fadeSpeed = parseInt(e.target.value);
            document.getElementById('fadeSpeedValue').textContent = e.target.value;
        });

        document.getElementById('pulseDuration').addEventListener('input', (e) => {
            settings.pulseDuration = parseInt(e.target.value);
            document.getElementById('pulseDurationValue').textContent = e.target.value;

            activeHieroglyphs.forEach(data => {
                data.element.style.animationDuration = `${settings.pulseDuration}s`;
            });
        });

        function applyPreset(preset) {
            if (preset === 'calm') {
                settings.cyclingSpeed = 400;
                settings.glowIntensity = 3;
                settings.activeGlyphs = 10;
                settings.fadeSpeed = 5;
                settings.pulseDuration = 6;
            } else if (preset === 'active') {
                settings.cyclingSpeed = 100;
                settings.glowIntensity = 8;
                settings.activeGlyphs = 35;
                settings.fadeSpeed = 2;
                settings.pulseDuration = 3;
            }

            document.getElementById('cyclingSpeed').value = settings.cyclingSpeed;
            document.getElementById('cyclingSpeedValue').textContent = settings.cyclingSpeed;
            document.getElementById('glowIntensity').value = settings.glowIntensity;
            document.getElementById('glowIntensityValue').textContent = settings.glowIntensity;
            document.getElementById('activeGlyphs').value = settings.activeGlyphs;
            document.getElementById('activeGlyphsValue').textContent = settings.activeGlyphs;
            document.getElementById('fadeSpeed').value = settings.fadeSpeed;
            document.getElementById('fadeSpeedValue').textContent = settings.fadeSpeed;
            document.getElementById('pulseDuration').value = settings.pulseDuration;
            document.getElementById('pulseDurationValue').textContent = settings.pulseDuration;

            updateGlowIntensity();

            activeHieroglyphs.forEach(data => {
                data.element.style.animationDuration = `${settings.pulseDuration}s`;

                if (data.cycleInterval) {
                    clearInterval(data.cycleInterval);
                    data.cycleInterval = setInterval(() => {
                        data.element.textContent = getRandomHieroglyph();
                    }, settings.cyclingSpeed);
                }
            });
        }

        // Start hieroglyphs immediately (always running)
        hieroglyphInterval = setInterval(manageHieroglyphs, 500);
        for (let i = 0; i < settings.activeGlyphs; i++) {
            setTimeout(() => createHieroglyph(), i * 100);
        }

        // Update mode toggle button text
        document.getElementById('modeToggle').textContent = 'Click 4 Times Fast for Emoji Rain! 🎉';

        // Fullscreen functionality
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log(`Error attempting to enable fullscreen: ${err.message}`);
                });
                document.getElementById('fullscreenBtn').textContent = '◱';
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                    document.getElementById('fullscreenBtn').textContent = '⛶';
                }
            }
        }

        // Update fullscreen button on fullscreen change
        document.addEventListener('fullscreenchange', () => {
            if (document.fullscreenElement) {
                document.getElementById('fullscreenBtn').textContent = '◱';
            } else {
                document.getElementById('fullscreenBtn').textContent = '⛶';
            }
        });
    </script>
</body>
</html>
